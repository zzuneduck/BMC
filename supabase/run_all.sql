-- ============================================
-- BMC VOD 시스템 전체 SQL (Supabase SQL Editor에서 실행)
-- 실행 순서대로 모두 한 번에 실행 가능
-- ============================================

-- ============================================
-- STEP 1: 스키마 변경 (컬럼 추가)
-- ============================================

-- vod_courses에 week 컬럼 추가
ALTER TABLE vod_courses ADD COLUMN IF NOT EXISTS week INTEGER;

-- vod_courses에 is_published, published_at 컬럼 추가 (없을 수 있음)
ALTER TABLE vod_courses ADD COLUMN IF NOT EXISTS is_published BOOLEAN DEFAULT true;
ALTER TABLE vod_courses ADD COLUMN IF NOT EXISTS published_at TIMESTAMPTZ;

-- vod_assignments에 start_date 컬럼 추가
ALTER TABLE vod_assignments ADD COLUMN IF NOT EXISTS start_date DATE;

-- vod_progress에 note 컬럼 추가 (어려운 부분 메모)
ALTER TABLE vod_progress ADD COLUMN IF NOT EXISTS note TEXT;

-- ============================================
-- STEP 2: 기존 VOD 강의 데이터 정리
-- ============================================

-- 기존 vod_progress, vod_courses 데이터 삭제
DELETE FROM vod_progress;
DELETE FROM vod_courses;

-- ============================================
-- STEP 3: 4주 커리큘럼 VOD 강의 데이터 INSERT
-- ============================================

-- 1주차: 블로그 기본강의 01~28
INSERT INTO vod_courses (week, title, course_type, category, order_num, is_published, published_at) VALUES
(1, '블로그 강의 들을까 말까? 고민되면 먼저보세요', 'blog', '기본 강의', 1, true, '2025-02-02T00:00:00+09:00'),
(1, '보편적 블로그 활용법 4가지', 'blog', '기본 강의', 2, true, '2025-02-02T00:00:00+09:00'),
(1, '동적인 콘텐츠, 정적인 콘텐츠', 'blog', '기본 강의', 3, true, '2025-02-02T00:00:00+09:00'),
(1, '블로그에 들어가는 리소스에 대해서', 'blog', '기본 강의', 4, true, '2025-02-02T00:00:00+09:00'),
(1, '블로그 수익화, 지금도 가능할까?', 'blog', '기본 강의', 5, true, '2025-02-02T00:00:00+09:00'),
(1, '블로그 운영 나이도에 대해서', 'blog', '기본 강의', 6, true, '2025-02-02T00:00:00+09:00'),
(1, '블로그 운영에 소요되는 시간에 대해서', 'blog', '기본 강의', 7, true, '2025-02-02T00:00:00+09:00'),
(1, '이 개념을 몰라서, 열심히 해도 제자리인겁니다.', 'blog', '기본 강의', 8, true, '2025-02-02T00:00:00+09:00'),
(1, '가장 빠르게 체험단 가는 블로그 세팅 가이드', 'blog', '기본 강의', 9, true, '2025-02-02T00:00:00+09:00'),
(1, '네이버 블로그 알아두면 좋은 용어 정리', 'blog', '기본 강의', 10, true, '2025-02-02T00:00:00+09:00'),
(1, '빠르게 블로그 스킨 만들기 [자료, 템플릿 제공]', 'blog', '기본 강의', 11, true, '2025-02-02T00:00:00+09:00'),
(1, '스마트에디터원 + 이미지', 'blog', '기본 강의', 12, true, '2025-02-02T00:00:00+09:00'),
(1, '발행 개념에 대해서 제대로 알아야 합니다.', 'blog', '기본 강의', 13, true, '2025-02-02T00:00:00+09:00'),
(1, '블로그 운영 팁 + 마인드셋', 'blog', '기본 강의', 14, true, '2025-02-02T00:00:00+09:00'),
(1, '블로그 구독 시스템에 대해서', 'blog', '기본 강의', 15, true, '2025-02-02T00:00:00+09:00'),
(1, '블로그 초보들이 자주 하는 실수 4가지', 'blog', '기본 강의', 16, true, '2025-02-02T00:00:00+09:00'),
(1, '블로그 초보가 자주 하는 키워드 실수', 'blog', '기본 강의', 17, true, '2025-02-02T00:00:00+09:00'),
(1, '저품질 블로그에 대해서', 'blog', '기본 강의', 18, true, '2025-02-02T00:00:00+09:00'),
(1, '네이버 블로그 흐름, 맥락 파악하기', 'blog', '기본 강의', 19, true, '2025-02-02T00:00:00+09:00'),
(1, '네이버 블로그 로직', 'blog', '기본 강의', 20, true, '2025-02-02T00:00:00+09:00'),
(1, '네이버 블로그 로직 + 지수 + 글쓰기', 'blog', '기본 강의', 21, true, '2025-02-02T00:00:00+09:00'),
(1, '키워드 찾는 방법', 'blog', '기본 강의', 22, true, '2025-02-02T00:00:00+09:00'),
(1, '수익화 1단계', 'blog', '기본 강의', 23, true, '2025-02-02T00:00:00+09:00'),
(1, '수익화 2단계', 'blog', '기본 강의', 24, true, '2025-02-02T00:00:00+09:00'),
(1, '수익화 3단계', 'blog', '기본 강의', 25, true, '2025-02-02T00:00:00+09:00'),
(1, '수익화 4단계', 'blog', '기본 강의', 26, true, '2025-02-02T00:00:00+09:00'),
(1, '수익화 5단계', 'blog', '기본 강의', 27, true, '2025-02-02T00:00:00+09:00'),
(1, '수익화 6단계', 'blog', '기본 강의', 28, true, '2025-02-02T00:00:00+09:00');

-- 2주차: 블로그 기본강의 29~56
INSERT INTO vod_courses (week, title, course_type, category, order_num, is_published, published_at) VALUES
(2, '블로그 수익화, 이래서 실패합니다.', 'blog', '기본 강의', 29, true, '2025-02-09T00:00:00+09:00'),
(2, '당신의 블로그가 안 되는 이유', 'blog', '기본 강의', 30, true, '2025-02-09T00:00:00+09:00'),
(2, '네이버 베인은 어떻게 해야 노출될까?', 'blog', '기본 강의', 31, true, '2025-02-09T00:00:00+09:00'),
(2, '키워드 [심화]', 'blog', '기본 강의', 32, true, '2025-02-09T00:00:00+09:00'),
(2, '카테고리와 타겟', 'blog', '기본 강의', 33, true, '2025-02-09T00:00:00+09:00'),
(2, '블로그 지수 디테일 ver. (미시적 관점)', 'blog', '기본 강의', 34, true, '2025-02-09T00:00:00+09:00'),
(2, '블로그의 종류_1', 'blog', '기본 강의', 35, true, '2025-02-09T00:00:00+09:00'),
(2, '블로그의 종류_2', 'blog', '기본 강의', 36, true, '2025-02-09T00:00:00+09:00'),
(2, '어떤 블로그를 어떻게 운영해야 할까?', 'blog', '기본 강의', 37, true, '2025-02-09T00:00:00+09:00'),
(2, '홈피드', 'blog', '기본 강의', 38, true, '2025-02-09T00:00:00+09:00'),
(2, '생성형 AI 글쓰기_1', 'blog', '기본 강의', 39, true, '2025-02-09T00:00:00+09:00'),
(2, '생성형 AI 글쓰기_2', 'blog', '기본 강의', 40, true, '2025-02-09T00:00:00+09:00'),
(2, '생성형 AI 글쓰기_3', 'blog', '기본 강의', 41, true, '2025-02-09T00:00:00+09:00'),
(2, '생성형 AI 글쓰기_4', 'blog', '기본 강의', 42, true, '2025-02-09T00:00:00+09:00'),
(2, '생성형 AI 글쓰기_5', 'blog', '기본 강의', 43, true, '2025-02-09T00:00:00+09:00'),
(2, '생성형 AI 글쓰기_6', 'blog', '기본 강의', 44, true, '2025-02-09T00:00:00+09:00'),
(2, '새로운 안경, 네이버와 AI', 'blog', '기본 강의', 45, true, '2025-02-09T00:00:00+09:00'),
(2, '검색과 광고', 'blog', '기본 강의', 46, true, '2025-02-09T00:00:00+09:00'),
(2, '발견과 가치판단', 'blog', '기본 강의', 47, true, '2025-02-09T00:00:00+09:00'),
(2, '네이버 블로그 거시적 흐름', 'blog', '기본 강의', 48, true, '2025-02-09T00:00:00+09:00'),
(2, '창작자 콘텐츠 기획의 변화', 'blog', '기본 강의', 49, true, '2025-02-09T00:00:00+09:00'),
(2, '홈피드 개념잡기', 'blog', '기본 강의', 50, true, '2025-02-09T00:00:00+09:00'),
(2, '사용자 활동 기반 추천 원리', 'blog', '기본 강의', 51, true, '2025-02-09T00:00:00+09:00'),
(2, '홈피드 추천 알고리즘', 'blog', '기본 강의', 52, true, '2025-02-09T00:00:00+09:00'),
(2, '홈피드, 그럼 글쓰기는 어떻게 해야 할까?_1', 'blog', '기본 강의', 53, true, '2025-02-09T00:00:00+09:00'),
(2, '홈피드, 그럼 글쓰기는 어떻게 해야 할까?_2', 'blog', '기본 강의', 54, true, '2025-02-09T00:00:00+09:00'),
(2, '[실전] 팔리는 글쓰기_1', 'blog', '기본 강의', 55, true, '2025-02-09T00:00:00+09:00'),
(2, '[실전] 팔리는 글쓰기_2', 'blog', '기본 강의', 56, true, '2025-02-09T00:00:00+09:00');

-- 2주차 별첨강의
INSERT INTO vod_courses (week, title, course_type, category, order_num, is_published, published_at) VALUES
(2, '[별첨] 네이버 알맹이 지수 관리하기 (편법)', 'blog', '별첨 강의', 1, true, '2025-02-09T00:00:00+09:00'),
(2, '[별첨] 백링크', 'blog', '별첨 강의', 2, true, '2025-02-09T00:00:00+09:00'),
(2, '[별첨] OSMU 원소스멀티유즈 권법', 'blog', '별첨 강의', 3, true, '2025-02-09T00:00:00+09:00'),
(2, '[별첨] 스레드 강의', 'blog', '별첨 강의', 4, true, '2025-02-09T00:00:00+09:00'),
(2, '[별첨] 사진 강의_기초', 'blog', '별첨 강의', 5, true, '2025-02-09T00:00:00+09:00'),
(2, '[별첨] 브랜딩 강의_1', 'blog', '별첨 강의', 6, true, '2025-02-09T00:00:00+09:00'),
(2, '[별첨] 브랜딩 강의_2', 'blog', '별첨 강의', 7, true, '2025-02-09T00:00:00+09:00'),
(2, '[별첨] 브랜딩 강의_3', 'blog', '별첨 강의', 8, true, '2025-02-09T00:00:00+09:00'),
(2, '[별첨] 브랜딩 강의_4', 'blog', '별첨 강의', 9, true, '2025-02-09T00:00:00+09:00');

-- 3주차: 브랜드블로그 기본세팅 + 시작점
INSERT INTO vod_courses (week, title, course_type, category, order_num, is_published, published_at) VALUES
(3, '[기본세팅] 강사 소개_완전 기초부터 차근차근 알려드리겠습니다', 'brand', '브랜드블로그', 1, true, '2025-02-16T00:00:00+09:00'),
(3, '[기본세팅] 첫 실전 경험, 첫 시장조사, 내 블로그 운영과는 달랐다', 'brand', '브랜드블로그', 2, true, '2025-02-16T00:00:00+09:00'),
(3, '[기본세팅] 대행 하기 전, 반드시 알아야 할 내용', 'brand', '브랜드블로그', 3, true, '2025-02-16T00:00:00+09:00'),
(3, '[기본세팅] 잘 된 블로그 vs 잘못된 블로그', 'brand', '브랜드블로그', 4, true, '2025-02-16T00:00:00+09:00'),
(3, '[기본세팅] 업종 공부 어떻게 시작해야 하나요?', 'brand', '브랜드블로그', 5, true, '2025-02-16T00:00:00+09:00'),
(3, '[기본세팅] 브랜드 블로그 업종별 난이도 (주관적)', 'brand', '브랜드블로그', 6, true, '2025-02-16T00:00:00+09:00'),
(3, '[시작점] 브랜드 블로그의 시작점', 'brand', '브랜드블로그', 7, true, '2025-02-16T00:00:00+09:00'),
(3, '[시작점] 키워드 툴, 블랙키위 활용하기', 'brand', '브랜드블로그', 8, true, '2025-02-16T00:00:00+09:00'),
(3, '[시작점] [심화] 키워드 설계법, 검색되는 글의 시작', 'brand', '브랜드블로그', 9, true, '2025-02-16T00:00:00+09:00'),
(3, '[시작점] 클릭률 2배 높이는 제목 짓는 법, 실전 키워드 팁', 'brand', '브랜드블로그', 10, true, '2025-02-16T00:00:00+09:00');

-- 4주차: 브랜드블로그 글쓰기실전 + 영업 + 운영 + 성장전략
INSERT INTO vod_courses (week, title, course_type, category, order_num, is_published, published_at) VALUES
(4, '[글쓰기실전] 브랜드 블로그 글쓰기 기본', 'brand', '브랜드블로그', 1, true, '2025-02-23T00:00:00+09:00'),
(4, '[글쓰기실전] 전문 지식 없이 전문가처럼 쓰는 법', 'brand', '브랜드블로그', 2, true, '2025-02-23T00:00:00+09:00'),
(4, '[글쓰기실전] 고객이 저장하는 글 vs 스크롤 넘기는 글', 'brand', '브랜드블로그', 3, true, '2025-02-23T00:00:00+09:00'),
(4, '[글쓰기실전] 의심을 확신으로 바꾸는 가치 입증 글', 'brand', '브랜드블로그', 4, true, '2025-02-23T00:00:00+09:00'),
(4, '[글쓰기실전] 구매로 연결되는 글', 'brand', '브랜드블로그', 5, true, '2025-02-23T00:00:00+09:00'),
(4, '[글쓰기실전] 관계 강화 글쓰기 (스토리텔링)', 'brand', '브랜드블로그', 6, true, '2025-02-23T00:00:00+09:00'),
(4, '[글쓰기실전] 돈 되는 글 + 주제 발굴 팁', 'brand', '브랜드블로그', 7, true, '2025-02-23T00:00:00+09:00'),
(4, '[영업과시스템] 주도적으로 고객을 여는 방법', 'brand', '브랜드블로그', 8, true, '2025-02-23T00:00:00+09:00'),
(4, '[영업과시스템] 인바운드_고객이 먼저 찾아오게 만드는 구조', 'brand', '브랜드블로그', 9, true, '2025-02-23T00:00:00+09:00'),
(4, '[영업과시스템] 상품 구성과 가격 설정 노하우', 'brand', '브랜드블로그', 10, true, '2025-02-23T00:00:00+09:00'),
(4, '[영업과시스템] 아웃바운드와 인바운드의 장단점 (+주관적 생각)', 'brand', '브랜드블로그', 11, true, '2025-02-23T00:00:00+09:00'),
(4, '[영업과시스템] 가격을 말하지 않고 가격을 설득하는 법', 'brand', '브랜드블로그', 12, true, '2025-02-23T00:00:00+09:00'),
(4, '[운영과재계약] 클라이언트와 일하는 법_계약부터 확장까지', 'brand', '브랜드블로그', 13, true, '2025-02-23T00:00:00+09:00'),
(4, '[운영과재계약] 첫 미팅 시 사용하는 질문 리스트', 'brand', '브랜드블로그', 14, true, '2025-02-23T00:00:00+09:00'),
(4, '[운영과재계약] 제안서 없이 제안하는 대화법', 'brand', '브랜드블로그', 15, true, '2025-02-23T00:00:00+09:00'),
(4, '[운영과재계약] 계약 시 주의사항 & 리스크를 피하기 위한 가이드라인', 'brand', '브랜드블로그', 16, true, '2025-02-23T00:00:00+09:00'),
(4, '[운영과재계약] 재계약을 유도하는 블로그 운영 루틴', 'brand', '브랜드블로그', 17, true, '2025-02-23T00:00:00+09:00'),
(4, '[운영과재계약] 영업 마인드셋', 'brand', '브랜드블로그', 18, true, '2025-02-23T00:00:00+09:00'),
(4, '[수익화와성장전략] 0원에서 월 300, 1인 대행으로 성장하는 길', 'brand', '브랜드블로그', 19, true, '2025-02-23T00:00:00+09:00'),
(4, '[수익화와성장전략] 수익화 단계별 성장 이야기', 'brand', '브랜드블로그', 20, true, '2025-02-23T00:00:00+09:00'),
(4, '[수익화와성장전략] 글쓰기 시간을 줄이고 효율을 높이는 루틴', 'brand', '브랜드블로그', 21, true, '2025-02-23T00:00:00+09:00'),
(4, '[수익화와성장전략] 장기 운영을 위한 마인드셋 & 소통법', 'brand', '브랜드블로그', 22, true, '2025-02-23T00:00:00+09:00'),
(4, '[수익화와성장전략] 1인 대행사 망하지 않으려면 반드시 지켜야 하는 운영 원칙', 'brand', '브랜드블로그', 23, true, '2025-02-23T00:00:00+09:00');

-- ============================================
-- STEP 4: VOD 숙제 데이터 INSERT
-- ============================================

-- 기존 숙제 데이터 삭제
DELETE FROM vod_submissions;
DELETE FROM vod_assignments;

INSERT INTO vod_assignments (week, title, description, start_date, due_date, points, is_active) VALUES
(1, '1주차 VOD 숙제 - 블로그 기본강의 01~28', '블로그 기본강의 01~28번까지 시청하고 핵심 내용을 정리해주세요.\n실습 URL과 궁금한 점도 함께 제출해주세요.', '2025-02-02', '2025-02-08', 10, true),
(2, '2주차 VOD 숙제 - 블로그 기본강의 29~56 + 별첨', '블로그 기본강의 29~56번과 별첨강의를 시청하고 핵심 내용을 정리해주세요.\n실습 URL과 궁금한 점도 함께 제출해주세요.', '2025-02-09', '2025-02-15', 10, true),
(3, '3주차 VOD 숙제 - 브랜드블로그 기본세팅 + 시작점', '브랜드블로그 기본세팅과 시작점 강의를 시청하고 핵심 내용을 정리해주세요.\n실습 URL과 궁금한 점도 함께 제출해주세요.', '2025-02-16', '2025-02-22', 10, true),
(4, '4주차 VOD 숙제 - 브랜드블로그 실전 + 영업 + 운영 + 성장', '브랜드블로그 글쓰기실전, 영업, 운영, 성장전략 강의를 시청하고 핵심 내용을 정리해주세요.\n실습 URL과 궁금한 점도 함께 제출해주세요.', '2025-02-23', '2025-03-01', 10, true);

-- ============================================
-- 완료! 확인 쿼리
-- ============================================
SELECT '스키마 변경 완료' as status;
SELECT 'vod_courses: ' || COUNT(*) || '개' as result FROM vod_courses;
SELECT 'vod_assignments: ' || COUNT(*) || '개' as result FROM vod_assignments;
